From 915ce583eb3140d9d16e15a405290679f0829a53 Mon Sep 17 00:00:00 2001
From: X512 <danger_mail@list.ru>
Date: Sun, 6 Jun 2021 22:30:08 +0900
Subject: kernel/arch/elf: implement for riscv64

Change-Id: I919ee4883af780f48385a53e5768eba35dde6423
---
 src/system/kernel/arch/riscv64/arch_elf.cpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/system/kernel/arch/riscv64/arch_elf.cpp b/src/system/kernel/arch/riscv64/arch_elf.cpp
index 763d6a1d03..78dc01444f 100644
--- a/src/system/kernel/arch/riscv64/arch_elf.cpp
+++ b/src/system/kernel/arch/riscv64/arch_elf.cpp
@@ -94,6 +94,7 @@ arch_elf_relocate_rela(struct elf_image_info *image,
 			case R_RISCV_NONE:
 				continue;
 			case R_RISCV_64:
+			case R_RISCV_JUMP_SLOT:
 				relocValue = symAddr + rel[i].r_addend;
 				break;
 			case R_RISCV_RELATIVE:
@@ -113,6 +114,7 @@ arch_elf_relocate_rela(struct elf_image_info *image,
 				rel[i].r_offset);
 			return B_BAD_ADDRESS;
 		}
+		*(Elf64_Addr *)relocAddr = relocValue;
 #endif
 	}
 
-- 
2.30.2

