From af67e892b146fe2e350bc6a5dccfe2261c324ec6 Mon Sep 17 00:00:00 2001
From: X512 <danger_mail@list.ru>
Date: Mon, 26 Jul 2021 03:07:09 +0900
Subject: kernel/arch_real_time_clock: implement for riscv64 (2)

Change-Id: Ifecfd74fd11fe2d22c8e9436afdfa307a6116bcf
---
 .../kernel/arch/riscv64/arch_real_time_clock.cpp    | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

diff --git a/src/system/kernel/arch/riscv64/arch_real_time_clock.cpp b/src/system/kernel/arch/riscv64/arch_real_time_clock.cpp
index c4bc17be48..5774df5fad 100644
--- a/src/system/kernel/arch/riscv64/arch_real_time_clock.cpp
+++ b/src/system/kernel/arch/riscv64/arch_real_time_clock.cpp
@@ -1,4 +1,5 @@
 #include <arch/real_time_clock.h>
+#include <boot/kernel_args.h>
 
 #include <real_time_clock.h>
 #include <real_time_data.h>
@@ -9,9 +10,15 @@
 status_t
 arch_rtc_init(kernel_args *args, struct real_time_data *data)
 {
-	bigtime_t systemTime = system_time();
-	uint64 rtcTime = HtifCmd(2, 0, 0);
-	data->arch_data.system_time_conversion_factor = rtcTime - systemTime;
+/*
+	data->arch_data.system_time_conversion_factor
+		= (1LL << 32) * 1000000LL / args->arch_args.timerFrequrency;
+
+	dprintf("timerFrequrency: %" B_PRIu64 "\n",
+		args->arch_args.timerFrequrency);
+	dprintf("system_time_conversion_factor: %" B_PRIu64 "\n",
+		data->arch_data.system_time_conversion_factor);
+*/
 	return B_OK;
 }
 
-- 
2.30.2

