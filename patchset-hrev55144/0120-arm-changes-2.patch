From 823acc66bc0c99080e36b43c4899cd198f9c0a17 Mon Sep 17 00:00:00 2001
From: X512 <danger_mail@list.ru>
Date: Mon, 26 Jul 2021 03:47:44 +0900
Subject: arm changes (2)

Change-Id: I2104300ad73eb7a0e11d1b24ab729e22cc359261
---
 build/jam/ArchitectureRules | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/build/jam/ArchitectureRules b/build/jam/ArchitectureRules
index 7a5ee4e91c..5ba6a504eb 100644
--- a/build/jam/ArchitectureRules
+++ b/build/jam/ArchitectureRules
@@ -39,7 +39,7 @@ rule ArchitectureSetup architecture
 	local archFlags ;
 	switch $(cpu) {
 		case ppc : archFlags += -mcpu=440fp ;
-		case arm : archFlags += -march=armv7-a -mfloat-abi=hard ;
+		case arm : archFlags += -march=armv7-a -mfloat-abi=hard -fno-omit-frame-pointer ;
 		case x86 : archFlags += -march=pentium ;
 		case riscv64 : archFlags += -march=rv64gc ;
 	}
@@ -397,9 +397,9 @@ rule KernelArchitectureSetup architecture
 
 	switch $(cpu) {
 		case arm :
-			HAIKU_KERNEL_PIC_LINKFLAGS += -z max-page-size=0x1000 ;
-			HAIKU_KERNEL_ADDON_LINKFLAGS += -z max-page-size=0x1000 ;
-			HAIKU_KERNEL_PIC_CCFLAGS = -fno-pic ;
+			HAIKU_KERNEL_CCFLAGS += -fpic ;
+			HAIKU_KERNEL_C++FLAGS += -fpic ;
+			HAIKU_KERNEL_PIC_LINKFLAGS = -shared ;
 
 		case arm64 :
 			HAIKU_KERNEL_PIC_LINKFLAGS += -z max-page-size=0x1000 ;
-- 
2.30.2

